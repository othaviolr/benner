<Window x:Class="SistemaGestao.Views.PedidosView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cadastro de Pedidos" 
        Height="650" Width="900"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- TÍTULO -->
        <TextBlock Grid.Row="0" 
                  Text="CADASTRO DE PEDIDOS" 
                  FontSize="24" 
                  FontWeight="Bold" 
                  Margin="0,0,0,20"/>

        <!-- SELECIONAR PESSOA -->
        <GroupBox Grid.Row="1" Header="Dados do Pedido" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Pessoa -->
                <TextBlock Grid.Row="0" Grid.Column="0" 
                          Text="Pessoa:*" 
                          VerticalAlignment="Center" 
                          Margin="0,5"/>
                <ComboBox Grid.Row="0" Grid.Column="1" 
                         ItemsSource="{Binding Pessoas}"
                         SelectedItem="{Binding PessoaSelecionada}"
                         DisplayMemberPath="Nome"
                         Height="25"
                         Margin="0,5"/>

                <!-- Forma de Pagamento -->
                <TextBlock Grid.Row="1" Grid.Column="0" 
                          Text="Forma Pagto:*" 
                          VerticalAlignment="Center" 
                          Margin="0,5"/>
                <ComboBox Grid.Row="1" Grid.Column="1" 
                         ItemsSource="{Binding FormasPagamento}"
                         SelectedItem="{Binding FormaPagamento}"
                         Height="25"
                         Margin="0,5"/>
            </Grid>
        </GroupBox>

        <!-- ADICIONAR PRODUTOS -->
        <GroupBox Grid.Row="2" Header="Adicionar Produtos" Padding="10" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Produto:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox Width="300" 
                         ItemsSource="{Binding Produtos}"
                         SelectedItem="{Binding ProdutoSelecionado}"
                         DisplayMemberPath="Nome"
                         Height="25"
                         Margin="0,0,20,0"/>

                <TextBlock Text="Quantidade:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Width="80" 
                        Text="{Binding Quantidade, UpdateSourceTrigger=PropertyChanged}"
                        Height="25"
                        Margin="0,0,20,0"/>

                <Button Content="Adicionar" 
                       Width="100" 
                       Height="30"
                       Command="{Binding AdicionarProdutoCommand}"/>
            </StackPanel>
        </GroupBox>

        <!-- GRID DE ITENS DO PEDIDO -->
        <DataGrid Grid.Row="3" 
                 ItemsSource="{Binding ItensPedido}"
                 AutoGenerateColumns="False"
                 IsReadOnly="True"
                 CanUserAddRows="False"
                 AlternatingRowBackground="LightGray"
                 Margin="0,0,0,10">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Produto" Binding="{Binding ProdutoNome}" Width="*"/>
                <DataGridTextColumn Header="Quantidade" Binding="{Binding Quantidade}" Width="100"/>
                <DataGridTextColumn Header="Valor Unit." Binding="{Binding ValorUnitario, StringFormat=C}" Width="120"/>
                <DataGridTextColumn Header="Subtotal" Binding="{Binding Subtotal, StringFormat=C}" Width="120"/>
                <DataGridTemplateColumn Header="Ações" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Remover" 
                                   Command="{Binding DataContext.RemoverProdutoCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                   CommandParameter="{Binding}"
                                   Width="80"
                                   Height="25"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- RODAPÉ COM VALOR TOTAL E BOTÕES -->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Valor Total -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="VALOR TOTAL:" 
                          FontSize="18" 
                          FontWeight="Bold" 
                          Margin="0,0,10,0"/>
                <TextBlock Text="{Binding ValorTotal, StringFormat=C}" 
                          FontSize="18" 
                          FontWeight="Bold" 
                          Foreground="Green"/>
            </StackPanel>

            <!-- Botões -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="Finalizar Pedido" 
                       Width="150" 
                       Height="40"
                       FontWeight="Bold"
                       Background="Green"
                       Foreground="White"
                       Margin="0,0,10,0"
                       Command="{Binding FinalizarPedidoCommand}"/>

                <Button Content="Novo Pedido" 
                       Width="120" 
                       Height="40"
                       Command="{Binding NovoPedidoCommand}"/>
            </StackPanel>
        </Grid>

    </Grid>
</Window>